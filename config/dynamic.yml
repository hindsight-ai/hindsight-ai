# ./config/dynamic.yml

http:
  middlewares:
    auth-errors:
      errors:
        status:
          - "401"
        service: oauth2-svc@docker
        query: "/oauth2/sign_in?rd=/"
    secure-headers:
      headers:
        forceSTSHeader: true
        stsSeconds: 2592000   # 30 days to start
        stsIncludeSubdomains: false
        stsPreload: false
    oauth-middleware:
      forwardAuth:
        address: "http://oauth2-proxy:4180/oauth2/auth"
        trustForwardHeader: true
        authResponseHeaders:
          - "X-Auth-Request-User"
          - "X-Auth-Request-Email"
          - "X-Auth-Request-Access-Token"
    cors-headers:
      headers:
        # Use Traefik's built-in CORS fields instead of wildcard headers.
        accessControlAllowOriginList:
          - "https://app.hindsight-ai.com"
          - "https://app-staging.hindsight-ai.com"
          - "http://localhost:3000"
        accessControlAllowMethods:
          - "GET"
          - "POST"
          - "PUT"
          - "DELETE"
          - "OPTIONS"
        accessControlAllowHeaders:
          - "Content-Type"
          - "Authorization"
        accessControlAllowCredentials: true
        addVaryHeader: true
