# Environment variables for Hindsight AI Backend Service

# --- Database Configuration ---
# These variables are typically used by SQLAlchemy to connect to the PostgreSQL database.
# Ensure these match your PostgreSQL setup (e.g., in infra/postgres/docker-compose.yml)
DATABASE_URL="postgresql://user:password@localhost:5432/hindsight_db"

# --- Transactional Email Configuration ---
# Choose your email provider: resend, sendgrid, or mailgun
EMAIL_PROVIDER="resend"

# Common email settings
FROM_EMAIL="support@hindsight-ai.com"
FROM_NAME="Hindsight AI"
REPLY_TO_EMAIL="support@hindsight-ai.com"

# Resend Configuration (Recommended - 3,000 emails/month free)
# Get API key from: https://resend.com/api-keys
RESEND_API_KEY="re_your_api_key_here"

# SendGrid Configuration (100 emails/day free)
# Get API key from: https://app.sendgrid.com/settings/api_keys
SENDGRID_API_KEY="SG.your_api_key_here"

# Mailgun Configuration (5,000 emails free for 3 months)
# Get API key and domain from: https://app.mailgun.com/app/domains
MAILGUN_API_KEY="your_mailgun_api_key_here"
MAILGUN_DOMAIN="mg.yourdomain.com"

# Email template directory (relative to service root)
EMAIL_TEMPLATE_DIR="core/templates/email"

# Rate limiting (prevents abuse)
EMAIL_RATE_LIMIT_HOUR="100"
EMAIL_RATE_LIMIT_DAY="1000"

# --- Support Contact Configuration ---
# Destination address for /support/contact requests
SUPPORT_EMAIL="support@hindsight-ai.com"
# Minimum interval (in seconds) between support contact emails per user
SUPPORT_CONTACT_MIN_INTERVAL_SECONDS="60"

# --- LLM (Large Language Model) Configuration ---
# Required for memory block consolidation suggestions.
# Currently supports Google Gemini API.
# Get your API key from Google AI Studio: https://aistudio.google.com/app/apikey
LLM_API_KEY="YOUR_GEMINI_API_KEY_HERE"

# The name of the LLM model to use for consolidation.
# Example: gemini-2.5-flash-preview-05-20
LLM_MODEL_NAME="gemini-2.5-flash-preview-05-20"

# --- Consolidation Worker Configuration ---
# Number of memory blocks to process in each batch during consolidation analysis.
# Default is 100.
CONSOLIDATION_BATCH_SIZE=100

# Threshold for fallback similarity analysis (TF-IDF + cosine similarity).
# Memory blocks with a score equal to or above this threshold are grouped as potential duplicates.
# A value of 0.4 is used for testing, typically 0.85 for production.
FALLBACK_SIMILARITY_THRESHOLD=0.4

# --- Other Configurations ---
# Add any other relevant environment variables here.
# For example, if you have a specific port for the FastAPI app:
# FASTAPI_PORT=8000

# Base URL for building links in emails (login/accept-invite, dashboard links)
# Production: https://app.hindsight-ai.com
# Staging:    https://app-staging.hindsight-ai.com
# Dev:        http://localhost:3000
APP_BASE_URL="http://localhost:3000"

# Comma-separated list of emails that should be elevated to superadmin on first login.
# Required for accessing internal admin tools (e.g., beta access console).
ADMIN_EMAILS=""

# Optional comma-separated list of emails that can manage beta access without superadmin status.
BETA_ACCESS_ADMINS=""

# Local development only: setting this to "true" impersonates dev@localhost as a superadmin.
# The backend will refuse to start with DEV_MODE=true unless it is running on localhost.
DEV_MODE="false"

# Optional override used in automated tests; leave "false" in real environments.
ALLOW_DEV_MODE="false"
